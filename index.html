<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
</head>
<style>
    /* Add your own styling based on Neumorphism design principles */
    /* Overall layout */
    .chat-container {
        display: flex;
        flex-direction: column;
        height: 100vh;
    }

    .header {
        padding: 20px;
        background-color: #F0F0F0;
        /* Add neumorphism styling here */
    }

    .chat-messages {
        flex-grow: 1;
        padding: 20px;
        background-color: #F5F5F5;
        /* Add neumorphism styling here */
    }

    .input-container {
        display: flex;
        align-items: center;
        padding: 20px;
        background-color: #F0F0F0;
        /* Add neumorphism styling here */
    }

    /* Chat message styling */
    .chat-messages .message-container {
        display: flex;
        justify-content: flex-start;
        margin-bottom: 10px;
    }

    .chat-messages .message-container.user-message {
        justify-content: flex-end;
    }

    .chat-messages .message {
        padding: 10px;
        border-radius: 10px;
        /* Add neumorphism styling here */
    }

    .chat-messages .user-message .message {
        background-color: #DCF8C6;
    }

    .chat-messages .model-message .message {
        background-color: #E8E8E8;
    }

    .chat-messages .message-text {
        max-width: 70%;
    }

    /* Input field and button */
    .message-input {
        flex-grow: 1;
        padding: 10px;
        border-radius: 10px;
        /* Add neumorphism styling here */
    }

    .send-button {
        padding: 10px 20px;
        margin-left: 10px;
        border-radius: 10px;
        /* Add neumorphism styling here */
    }
</style>
<body>
    <div class="chat-container">
        <div class="header">
            <h1 class="chat-title">WhatsApp Chat</h1>
            <!-- Add additional controls or icons here -->
        </div>
        <div class="chat-messages" id="chat-messages">
            <!-- Chat messages will be dynamically added here -->
        </div>
        <div class="input-container">
            <input type="text" class="message-input" id="message-input" placeholder="Type your message...">
            <button class="send-button" id="send-button">Send</button>
        </div>
    </div>
</body>

<script>
    // Get elements
    const messageInput = document.getElementById('message-input');
    const sendButton = document.getElementById('send-button');
    const chatMessages = document.getElementById('chat-messages');

    // Handle send button click
    sendButton.addEventListener('click', async function() {
        const message = messageInput.value.trim();

        if (message !== '') {
            // Display user message in the chat interface
            displayMessage('user', message);

            // Detect user intent
            const intent = detectIntent(message);


            // Take appropriate action based on intent
            switch (intent) {
                case 'greeting':
                    handleGreeting();
                    break;
                case 'identity':
                    handleIdentity();
                    break;
                default:
                    // No specific intent detected, send the message to the model
                    const context = createContext(intent);
                    const response = await sendMessageToModel(message, context);
                    if (response) {
                        displayMessage('model', response);
                    } else {
                        displayMessage('model', 'Oops! Something went wrong. Please try again.');
                    }
                    break;
            }

            // Clear the input field
            messageInput.value = '';
        }
    });

    // Function to determine user intent based on message content
    function detectIntent(message) {
        const lowerCaseMessage = message.toLowerCase();

        if (lowerCaseMessage.includes('hello') || lowerCaseMessage.includes('hi')) {
            return 'greeting';
        } else if (lowerCaseMessage.includes('who') && lowerCaseMessage.includes('you')) {
            return 'identity';
        }

        // If no specific intent is detected, return a default intent
        return 'default';
    }

    // Function to create context based on intent
    function createContext(intent) {
        switch (intent) {
            case 'greeting':
                return 'You\'re a helpful assistant.';
            default:
                return '';
        }
    }

    // Handle greeting intent
    function handleGreeting() {
        const greetingResponse = 'Hello! How can I assist you today?';
        displayMessage('model', greetingResponse);
    }

    // Handle identity intent
    function handleIdentity() {
        const identityResponse = 'I\'m a helpful assistant here to provide you with information and assistance.';
        displayMessage('model', identityResponse);
    }

    // Function to send user message and context to the ChatGPT model
    async function sendMessageToModel(message, context) {
    try {
        const response = await fetch('https://api.openai.com/v1/engines/davinci-codex/completions', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'Authorization': 'Bearer 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',
            },
            body: JSON.stringify({
                prompt: message,
                max_tokens: 100,
                temperature: 0.7,
                n: 1,
                stop: '\n',
                context: context,
            }),
        });

        if (!response.ok) {
            throw new Error('Request failed with status: ' + response.status);
        }

        const data = await response.json();
        const modelReply = data.choices[0].text.trim();
        return modelReply;
    } catch (error) {
        console.error(error);
        return null;
    }
}



    // Display message in the chat interface
    function displayMessage(sender, message) {
        const messageContainer = document.createElement('div');
        messageContainer.classList.add('message-container');
        messageContainer.classList.add(sender + '-message');

        const messageBubble = document.createElement('div');
        messageBubble.classList.add('message');

        const messageText = document.createElement('div');
        messageText.classList.add('message-text');
        messageText.textContent = message;

        messageBubble.appendChild(messageText);
        messageContainer.appendChild(messageBubble);

        chatMessages.appendChild(messageContainer);
        chatMessages.scrollTop = chatMessages.scrollHeight;
    }
</script>
</html>
